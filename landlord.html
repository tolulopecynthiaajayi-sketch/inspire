<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Landlord Portal | Alora Group</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Firebase SDK (Compat) -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="./js/firebaseConfig.js"></script>

    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Open+Sans:wght@400;600&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Open Sans', sans-serif;
            background-color: #F1F5F9;
        }

        h1,
        h2,
        h3,
        h4,
        .nav-link {
            font-family: 'Montserrat', sans-serif;
        }

        .bg-navy-primary {
            background-color: #1E3A8A;
        }

        .bg-navy-dark {
            background-color: #0F172A;
        }

        .text-navy-primary {
            color: #1E3A8A;
        }

        .bg-peach-accent {
            background-color: #D9654C;
        }

        .text-peach-accent {
            color: #D9654C;
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        const Icon = ({ name, size = 20, className = "" }) => {
            const iconName = name.charAt(0).toUpperCase() + name.slice(1);
            if (!window.lucide || !window.lucide.icons || !window.lucide.icons[iconName]) return null;
            const iconDef = window.lucide.icons[iconName];
            return (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    {iconDef.map((child, index) => React.createElement(child[0], { ...child[1], key: index }))}
                </svg>
            );
        };

        const NavBar = () => (
            <nav className="bg-navy-dark text-white shadow-md sticky top-0 z-50">
                <div className="max-w-7xl mx-auto px-4">
                    <div className="flex justify-between h-20 items-center">
                        <div className="flex items-center gap-3">
                            <a href="index.html">
                                <img src="logo.png" alt="Alora" className="h-12 w-auto object-contain filter invert mix-blend-screen" />
                            </a>
                            <span className="font-bold text-white text-lg tracking-wider border-l border-gray-600 pl-4 ml-2">LANDLORD SUITE</span>
                        </div>



                        <div className="flex items-center gap-4">
                            <div className="flex items-center gap-2 text-sm">
                                <span className="hidden md:inline text-gray-300">Welcome, Pierre</span>
                            </div>
                            <button className="bg-peach-accent px-4 py-2 rounded text-xs font-bold uppercase tracking-wide hover:bg-white hover:text-navy-primary transition">List Property</button>
                        </div>
                    </div>
                </div>
            </nav>
        );

        const Dashboard = () => {
            const [activeTab, setActiveTab] = useState('tenants');

            // Mock Data for Tenant Matching
            // Context: French Market (Guarantor is key, >3x rent is standard)
            const [listings, setListings] = useState([
                { id: 1, name: 'Studio Montmartre', rent: 950, location: '18th Arr.', status: 'Occupied' },
                { id: 2, name: '2BR Le Marais', rent: 1800, location: '4th Arr.', status: 'Vacant' }
            ]);

            // Add Property Form State
            const [newProperty, setNewProperty] = useState({ name: '', location: '', rent: '', status: 'Vacant' });

            const handleAddProperty = (e) => {
                e.preventDefault();
                const property = {
                    id: Date.now(),
                    ...newProperty,
                    rent: parseInt(newProperty.rent)
                };
                setListings([...listings, property]);
                setActiveTab('listings'); // Return to listings after add
                setNewProperty({ name: '', location: '', rent: '', status: 'Vacant' }); // Reset form
            };

            const [selectedProperty, setSelectedProperty] = useState(listings[0].id);

            const students = [
                { id: 1, name: 'Sarah M.', age: 23, origin: 'USA', status: 'Master Student', guarantor: 'Visale (State)', income: 3200, docs: 100, avatar: 'bg-green-100 text-green-600' },
                { id: 2, name: 'Wei C.', age: 25, origin: 'China', status: 'PhD Candidate', guarantor: 'Garantme', income: 2800, docs: 90, avatar: 'bg-blue-100 text-blue-600' },
                { id: 3, name: 'Elena R.', age: 21, origin: 'Spain', status: 'Erasmus', guarantor: 'Personal (Parent)', income: 2100, docs: 80, avatar: 'bg-purple-100 text-purple-600' },
                { id: 4, name: 'John D.', age: 22, origin: 'UK', status: 'Intern', guarantor: 'None', income: 1000, docs: 50, avatar: 'bg-gray-100 text-gray-600' },
            ];

            // Smart Matching Algorithm
            const getMatchScore = (student, propertyId) => {
                const property = listings.find(l => l.id === parseInt(propertyId));
                let score = 0;

                // 1. Guarantor Logic (Critical for French Landlords - Heavily Weighted)
                if (student.guarantor.includes('Visale') || student.guarantor.includes('Garantme')) score += 60; // High trust for ensured guarantors
                else if (student.guarantor.includes('Parent')) score += 40;
                else score -= 20; // No guarantor is a red flag

                // 2. Status Bonuses
                if (student.status.includes('PhD') || student.status.includes('Scholarship')) score += 20;
                if (student.docs === 100) score += 20;



                return Math.min(100, Math.max(0, score)); // Cap at 0-100
            };

            const sortedStudents = [...students].map(s => ({ ...s, score: getMatchScore(s, selectedProperty) })).sort((a, b) => b.score - a.score);

            return (
                <div className="max-w-7xl mx-auto px-4 py-8">
                    {/* Stats Overview */}
                    <div className="grid md:grid-cols-4 gap-6 mb-8">
                        <div className="bg-white p-5 rounded shadow border-l-4 border-navy-primary">
                            <h4 className="text-gray-500 text-xs font-bold uppercase tracking-wider">Total Listings</h4>
                            <p className="text-3xl font-bold text-navy-dark">12</p>
                        </div>
                        <div className="bg-white p-5 rounded shadow border-l-4 border-green-500">
                            <h4 className="text-gray-500 text-xs font-bold uppercase tracking-wider">Occupancy Rate</h4>
                            <p className="text-3xl font-bold text-navy-dark">92%</p>
                        </div>
                        <div className="bg-white p-5 rounded shadow border-l-4 border-peach-accent">
                            <h4 className="text-gray-500 text-xs font-bold uppercase tracking-wider">Pending Requests</h4>
                            <p className="text-3xl font-bold text-navy-dark">5</p>
                        </div>
                        <div className="bg-white p-5 rounded shadow border-l-4 border-purple-500">
                            <h4 className="text-gray-500 text-xs font-bold uppercase tracking-wider">This Month Revenue</h4>
                            <p className="text-3xl font-bold text-navy-dark">€8,450</p>
                        </div>
                    </div>

                    {/* Tabs */}
                    <div className="flex gap-4 border-b border-gray-300 mb-6">
                        <button onClick={() => setActiveTab('listings')} className={`pb-3 font-bold text-sm uppercase ${activeTab === 'listings' ? 'text-navy-primary border-b-2 border-navy-primary' : 'text-gray-500'}`}>My Listings</button>
                        <button onClick={() => setActiveTab('tenants')} className={`pb-3 font-bold text-sm uppercase ${activeTab === 'tenants' ? 'text-navy-primary border-b-2 border-navy-primary' : 'text-gray-500'} flex items-center gap-2`}>
                            <Icon name="sparkles" size={16} className="text-peach-accent" /> Smart Tenant Matching
                        </button>
                    </div>

                    {/* MY LISTINGS */}
                    {activeTab === 'listings' && (
                        <div className="animate-fade-in">
                            <div className="flex justify-between items-center mb-4">
                                <h3 className="font-bold text-lg text-gray-800">Active Properties</h3>
                                <button onClick={() => setActiveTab('add-property')} className="text-navy-primary text-sm font-bold flex items-center gap-1 hover:underline"><Icon name="plus" size={16} /> Add New Listing</button>
                            </div>
                            <div className="bg-white shadow rounded-lg overflow-hidden">
                                <table className="w-full text-left text-sm text-gray-600">
                                    <thead className="bg-gray-50 uppercase text-xs font-bold text-gray-500">
                                        <tr>
                                            <th className="p-4">Property</th>
                                            <th className="p-4">Location</th>
                                            <th className="p-4">Status</th>
                                            <th className="p-4">Rent</th>
                                            <th className="p-4">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-gray-100">
                                        <tr className="hover:bg-gray-50">
                                            <td className="p-4 font-bold text-gray-900">Studio Montmartre</td>
                                            <td className="p-4">18th Arr.</td>
                                            <td className="p-4"><span className="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-bold">Occupied</span></td>
                                            <td className="p-4">€950</td>
                                            <td className="p-4 text-blue-600 hover:underline cursor-pointer">Manage</td>
                                        </tr>
                                        <tr className="hover:bg-gray-50">
                                            <td className="p-4 font-bold text-gray-900">2BR Le Marais</td>
                                            <td className="p-4">4th Arr.</td>
                                            <td className="p-4"><span className="bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs font-bold">Vacant</span></td>
                                            <td className="p-4">€1,800</td>
                                            <td className="p-4 text-blue-600 hover:underline cursor-pointer">Manage</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    )}

                    {/* ADD PROPERTY FORM */}
                    {activeTab === 'add-property' && (
                        <div className="animate-fade-in max-w-2xl mx-auto bg-white p-8 rounded-lg shadow-sm border border-gray-200">
                            <h3 className="font-bold text-xl text-navy-primary mb-6 flex items-center gap-2"><Icon name="home" /> Add New Property</h3>
                            <form onSubmit={handleAddProperty} className="space-y-6">
                                <div>
                                    <label className="block text-xs font-bold text-gray-500 uppercase mb-2">Property Name / Title</label>
                                    <input
                                        type="text"
                                        required
                                        placeholder="e.g. Cozy Studio near Sorbonne"
                                        className="w-full p-3 border rounded border-gray-200 focus:border-peach-accent outline-none"
                                        value={newProperty.name}
                                        onChange={e => setNewProperty({ ...newProperty, name: e.target.value })}
                                    />
                                </div>
                                <div className="grid grid-cols-2 gap-6">
                                    <div>
                                        <label className="block text-xs font-bold text-gray-500 uppercase mb-2">Location (Arrondissement)</label>
                                        <input
                                            type="text"
                                            required
                                            placeholder="e.g. 5th Arr."
                                            className="w-full p-3 border rounded border-gray-200 focus:border-peach-accent outline-none"
                                            value={newProperty.location}
                                            onChange={e => setNewProperty({ ...newProperty, location: e.target.value })}
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-xs font-bold text-gray-500 uppercase mb-2">Monthly Rent (€)</label>
                                        <input
                                            type="number"
                                            required
                                            placeholder="e.g. 1200"
                                            className="w-full p-3 border rounded border-gray-200 focus:border-peach-accent outline-none"
                                            value={newProperty.rent}
                                            onChange={e => setNewProperty({ ...newProperty, rent: e.target.value })}
                                        />
                                    </div>
                                </div>
                                <div className="flex justify-end gap-3 pt-4">
                                    <button type="button" onClick={() => setActiveTab('listings')} className="px-6 py-2 text-gray-500 font-bold hover:text-gray-700">Cancel</button>
                                    <button type="submit" className="px-6 py-2 bg-navy-primary text-white font-bold rounded shadow hover:bg-navy-dark transition">Save Listing</button>
                                </div>
                            </form>
                        </div>
                    )
                    }

                    {/* AI TENANT MATCHING */}
                    {
                        activeTab === 'tenants' && (
                            <div className="animate-fade-in">
                                <div className="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                                    <div>
                                        <h3 className="font-bold text-lg text-gray-800 flex items-center gap-2"><Icon name="users" className="text-peach-accent" /> Smart Tenant Matcher</h3>
                                        <p className="text-sm text-gray-500">Our system ranks applicants based on your criteria (Guarantor, Status, Reliability).</p>
                                    </div>
                                    <div className="flex items-center gap-2 bg-white px-3 py-2 rounded border border-gray-200 shadow-sm">
                                        <span className="text-xs font-bold uppercase text-gray-500">Matching For:</span>
                                        <select
                                            className="text-sm font-bold text-navy-primary bg-transparent outline-none cursor-pointer"
                                            value={selectedProperty}
                                            onChange={(e) => setSelectedProperty(e.target.value)}
                                        >
                                            {listings.map(l => <option key={l.id} value={l.id}>{l.name} (€{l.rent})</option>)}
                                        </select>
                                    </div>
                                </div>

                                <div className="grid md:grid-cols-3 gap-6">
                                    {sortedStudents.map((student, i) => (
                                        <div key={student.id} className={`bg-white p-6 rounded-lg shadow transition relative border-t-4 ${student.score >= 90 ? 'border-green-500' : student.score >= 70 ? 'border-yellow-500' : 'border-red-500'}`}>

                                            {/* Match Score Badge */}
                                            <div className="absolute top-4 right-4 flex flex-col items-end">
                                                <span className={`text-2xl font-black ${student.score >= 80 ? 'text-green-600' : 'text-yellow-600'}`}>{student.score}%</span>
                                                <span className="text-[10px] font-bold uppercase text-gray-400">Match Confidence</span>
                                            </div>

                                            <div className="flex items-center gap-4 mb-6">
                                                <div className={`w-12 h-12 rounded-full flex items-center justify-center font-bold text-lg ${student.avatar}`}>
                                                    {student.name.charAt(0)}
                                                </div>
                                                <div>
                                                    <h4 className="font-bold text-gray-900">{student.name} <span className="text-xs font-normal text-gray-500">({student.origin})</span></h4>
                                                    <p className="text-xs text-gray-500">{student.status} • {student.age}yo</p>
                                                </div>
                                            </div>

                                            <div className="space-y-3 mb-6 bg-gray-50 p-4 rounded text-sm">
                                                <div className="flex justify-between">
                                                    <span className="text-gray-500 text-xs uppercase font-bold">Guarantor</span>
                                                    <span className={`font-bold ${student.guarantor.includes('None') ? 'text-red-500' : 'text-navy-primary'}`}>{student.guarantor}</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span className="text-gray-500 text-xs uppercase font-bold">Documents</span>
                                                    <span className="font-bold text-blue-600">{student.docs}% Complete</span>
                                                </div>
                                            </div>

                                            <div className="flex gap-2">
                                                <button className="flex-1 bg-navy-primary text-white py-3 rounded text-xs font-bold uppercase hover:bg-navy-dark shadow-md transition">Approve</button>
                                                <button className="flex-1 border border-gray-300 text-gray-600 py-3 rounded text-xs font-bold uppercase hover:bg-gray-50 transition">View Dossier</button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )
                    }
                </div >
            );
        };

        const App = () => (
            <div>
                <NavBar />
                <Dashboard />
            </div>
        );

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>